<!DOCTYPE html>
<!--
Created by       : Luis MartinGarcia <http://www.aldabaknocking.com>
Original design  : "Collaboration" by Free CSS Templates (later "TEMPLATED")
Original license : Creative Commons Attribution 2.5 License
-->
<html lang="en">

    <!-- HEAD -->
    <head>
        <meta charset="utf-8">
        <title>LINKTYPE_LINUX_SLL2 | TCPDUMP &amp; LIBPCAP</title>
        <meta name="keywords" content="tcpdump, libpcap, pcap, packet capture, sniffer, security, eavesdrop">
        <meta name="description" content="Web site of Tcpdump and Libpcap">
        <link href="../style.css" rel="stylesheet" type="text/css" media="screen">
        <link href="../images/T-32x32.png" rel="shortcut icon" type="image/png">
    </head>
    <!-- END OF HTML HEAD -->

    <!-- BODY -->
    <body>

        <!-- TOP MENU -->
        <div id="menu">
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../security.html">Security</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../manpages/">Man Pages</a></li>
                <li><a href="../ci.html">CI</a></li>
                <li><a href="../linktypes.html">Link-Layer Header Types</a></li>
                <li><a href="../related.html">See Also</a></li>
                <li><a href="../old_releases.html">Old Releases</a></li>
            </ul>
        </div>
        <!-- END OF TOP MENU -->

        <!-- PAGE HEADER -->
        <div id="splash">
            <br><img src="../images/logo.png" alt="">
        </div>
        <div id="logo">
            <hr>
        </div>
        <!-- END OF PAGE HEADER -->

        <!-- PAGE CONTENTS -->
        <div id="page">

          <!-- Start of LINKTYPE_LINUX_SLL2 section -->
          <div class="post">
            <h2 class="title">
                LINKTYPE_LINUX_SLL2
            </h2>
            <div class="entry">
                <h3>Packet structure</h3>
<pre>
+---------------------------+
|        Protocol type      |
|         (2 Octets)        |
+---------------------------+
|       Reserved (MBZ)      |
|         (2 Octets)        |
+---------------------------+
|       Interface index     |
|         (4 Octets)        |
+---------------------------+
|        ARPHRD_ type       |
|         (2 Octets)        |
+---------------------------+
|         Packet type       |
|         (1 Octet)         |
+---------------------------+
| Link-layer address length |
|         (1 Octets)        |
+---------------------------+
|    Link-layer address     |
|         (8 Octets)        |
+---------------------------+
|           Payload         |
.                           .
.                           .
.                           .
</pre>

                <h3>Description</h3>
<p>
The protocol type field is in network byte order.
</p>
<p>
The <code>ARPHRD_</code> type field is in network byte order; it contains a Linux
<code>ARPHRD_</code> value for the link-layer device type.
</p>
<p>
If the <code>ARPHRD_</code> type is <code>ARPHRD_IPGRE</code> (778), the protocol type field
contains a <a class=away href="https://tools.ietf.org/html/rfc2784">GRE</a>
protocol type.
</p>
<p>
If the <code>ARPHRD_</code> type is <code>ARPHRD_IEEE80211_RADIOTAP</code> (803), the protocol
type field is ignored, and the payload following the <code>LINKTYPE_LINUX_SLL</code>
header begins with <a class=away href="http://www.radiotap.org/">Radiotap
link-layer information</a> followed by an 802.11 header.
</p>
<p>
If the <code>ARPHRD_</code> type is <code>ARPHRD_FRAD</code> (770), the protocol type field is
ignored, and the payload following the <code>LINKTYPE_LINUX_SLL</code> header is a
Frame Relay LAPF frame, beginning with a <a class=away
href="https://www.itu.int/rec/T-REC-Q.922/en/">ITU-T Recommendation
Q.922</a> LAPF header starting with the address field, and without an
FCS at the end of the frame. 
</p>
<p>
Otherwise, the protocol type field contains the Ethernet protocol
type for the packet, or one of:
</p>
<ul>
<li><code>0x0001</code>, if the frame is a Novell 802.3 frame without an 802.2 LLC
header;</li>
<li><code>0x0003</code>, in some mysterious cases;</li>
<li><code>0x0004</code>, if the frame begins with an 802.2 LLC header;</li>
<li><code>0x000C</code>, if the frame is a CAN bus frame that begins with a header of
the form:

<pre>
+---------------------------+
|      CAN ID and flags     |
|         (4 Octets)        |
+---------------------------+
|    Frame payload length   |
|         (1 Octet)         |
+---------------------------+
|          Padding          |
|         (1 Octet)         |
+---------------------------+
|      Reserved/Padding     |
|         (1 Octet)         |
+---------------------------+
|      Reserved/Padding     |
|         (1 Octet)         |
+---------------------------+
</pre>

<p>
where the field containing the CAN ID and flags is in host byte order.
The bottom 29 bits contain the CAN ID of the frame.  The remaining bits
are:
</p>
<ul>
<li><code>0x20000000</code> - set if the frame is an error message rather than a data
frame;
<li><code>0x40000000</code> - set if the frame is a remote transmission request
frame;
<li><code>0x80000000</code> - set if the frame is an extended 29-bit frame rather
than a standard 11-bit frame;
</ul>
and the header is followed by the payload.</li>

<li><code>0x000D</code>, if the frame is a CAN FD (CAN with Flexible Data-Rate) frame
that begins with a header of the form:

<pre>
+---------------------------+
|      CAN ID and flags     |
|         (4 Octets)        |
+---------------------------+
|    Frame payload length   |
|         (1 Octet)         |
+---------------------------+
|         FD flags          |
|         (1 Octet)         |
+---------------------------+
|      Reserved/Padding     |
|         (1 Octet)         |
+---------------------------+
|      Reserved/Padding     |
|         (1 Octet)         |
+---------------------------+
</pre>

<p>
where the field containing the CAN ID and flags is in host byte order.
The bottom 29 bits of that field contain the CAN ID of the frame.  The
remaining bits are:
</p>
<ul>
<li><code>0x80000000</code> - set if the frame is an extended 29-bit frame rather
than a standard 11-bit frame.</li>
</ul>
The bits of the FD flags field are:
<ul>
<li><code>0x01</code> - set if the bit rate switch flag is set for the frame;</li>
<li><code>0x02</code> - set if the error state indicator is set for the frame;</li>
</ul>
and the header is followed by the payload.</li>
</ul>
<p>The "Reserved (MBZ)" field is reserved, and must be set to zero.
</p>
<p>
The interface index field is a signed integer in network byte order and
contains the 1-based index of the interface on which the packet was observed.
</p>
<p>
The packet type field contains a value that is one of:
</p>
<ul>
<li>0, if the packet was specifically sent to us by somebody else;</li>
<li>1, if the packet was broadcast by somebody else;</li>
<li>2, if the packet was multicast, but not broadcast, by somebody
else;</li>
<li>3, if the packet was sent to somebody else by somebody else;</li>
<li>4, if the packet was sent by us.</li>
</ul>
<p>
The link-layer address length field contains the length of the link-layer
address of the sender of the packet.  That length could be zero.
</p>
<p>
The link-layer address field contains the link-layer address of the
sender of the packet; the number of bytes of that field that are
meaningful is specified by the link-layer address length field.  If
there are more than 8 bytes, only the first 8 bytes are present, and
if there are fewer than 8 bytes, there are padding bytes after the
address to pad the field to 8 bytes.
</p>
            </div>
            <!-- End of LINKTYPE_LINUX_SLL2 section -->
          </div>
        </div>
        <!-- END OF PAGE CONTENTS -->

        <!-- FOOTER -->
        <div id="footer">
            <p>
                &copy; 2010&ndash;2021 The Tcpdump Group. Designed by
                <a class=away href="https://www.luismg.com/">Luis MartinGarcia</a>;
                based on a template by TEMPLATED.
            </p>
        </div>
        <!-- END OF FOOTER -->

    </body>
    <!-- END OF HTML BODY -->
</html>
